name: Docker Build Workflow Caller

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  default-workflow:
    name: Default Server
    uses: ./.github/workflows/ap-docker-workflow.yml
    with:
      server: 'paper'
      proxy: false
    secrets: inherit

  plugin-workflows:
    name: Plugin Servers
    strategy:
      matrix:
        servers: ['mirai','patina','pearl','pufferfish','purpur','spigot','sponge','windspigot']
    uses: ./.github/workflows/ap-docker-workflow.yml
    with:
      server: ${{ matrix.servers }}
      proxy: false
    secrets: inherit

  mod-workflows:
    name: Mod Servers
    strategy:
      matrix:
        servers: ['fabric']
    uses: ./.github/workflows/ap-docker-workflow.yml
    with:
      server: ${{ matrix.servers }}
      proxy: false
    secrets: inherit

  proxy-workflows:
    name: Proxy Servers
    strategy:
      matrix:
        servers: ['bungeecord','travertine','velocity','waterfall']
    uses: ./.github/workflows/ap-docker-workflow.yml
    with:
      server: ${{ matrix.servers }}
      proxy: true
    secrets: inherit
